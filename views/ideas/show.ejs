<% include ../partials/header.ejs %>
    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <div class="thumbnail">
                <img src="<%= idea.imagePath %>" class="img-responsive" id="showIdeaImg">
                <div class="caption">
        
                    <!-- <div>
                        <h4 class="headline"> <%=idea.name %> </h4>
                        <p class="headline" style="float: right; margin-top: 5px"><%= idea.date.split(" ")[0] %></p>
                    </div> -->

                    <p> 
                        <span style="font-size: 20px">  <%=idea.name %> </span>
                        <span class="pull-right"> <%= idea.date.split(" ")[0] %> </span>
                    </p>

                    <p tabindex="0"> <%= idea.description %></p>
                    <p>
                        <em> Submitted By <a href="/users/<%= idea.user._id %>"><%= idea.user.username %> </a></em>
                        <span style="float:right;">
                            <%= idea.totalLikes %>  
                            <label for="sendLike">
                                <% if(idea.isLiked){ %>
                                    <i class="fas fa-lightbulb"></i>                                      
                                <% } else { %>
                                    <i class="far fa-lightbulb"></i>
                                <% } %>
                            </label>             
                            <form action="/ideas/<%= idea.id %>/likes" id="like" method="POST" style="display: none">
                                <input type="submit" id="sendLike">
                            </form>                                            
                        </span>
                    </p>
                    <% if(currentUser && (idea.user._id.equals(currentUser._id) || currentUser.isAdmin)) { %>
                    <a href="/ideas/<%=idea._id%>/edit" class="btn btn-warning" style="border: none; color: #574b4f">Edit</a>
                    <form action="/ideas/<%=idea._id%>?_method=DELETE" method="POST" class="delete-form" style="display: inline">
                        <button class="btn btn-danger" style="border: none; color: #574b4f">Delete</button>
                    </form>
                    <% } %>
                </div>
            </div>

            <div>
                <hr id="commentsLine">
                <br>
                <% idea.comments.forEach(function(comment){ %>
                <div class="row">
                    <div class="col-md-12">
                        <strong><%= comment.user.username %></strong>
                        <span class="pull-right"> <%= comment.date %> </span>
                        <p>
                            <%= comment.text %>
                        </p>
                        <% if(currentUser && (comment.user._id.equals(currentUser._id) || currentUser.isAdmin)){ %>           
                            <a class="btn btn-xs btn-warning"
                            style="border: none; color: #574b4f"
                            href="/ideas/<%=idea._id%>/comments/<%=comment._id%>/edit">
                            Edit
                            </a>
                            <form action="/ideas/<%=idea._id%>/comments/<%=comment._id%>?_method=DELETE" method="POST" class="delete-form" style="display: inline">
                                <input type="submit" class="btn btn-xs btn-danger" style="border: none; color: #574b4f" value="Delete">
                            </form>
                        <% } %>
                    </div>
                </div>
                <br>
                <% }); %>
                <div>
                    <a class="btn" id="newCommentButton" href="/ideas/<%=idea._id%>/comments/new">Add New Comment</a>
                </div>

                <br>
            </div>

        </div>
    </div>

<% include ../partials/footer.ejs %>